import{b as Z,c as X}from"./apis-a18fc85a.js";import{d as H,g as ee,_ as V,r as p,o as l,c as u,a as e,F as w,e as L,f as m,h as E,i as C,t as N,w as O,p as te,j as se,k as ae,l as oe}from"./index-a371b580.js";import{r as ne,a as ie,b as re,c as ce}from"./selector-engine-3934a713.js";import{r as le,a as de,b as he,c as _e}from"./scrollbar-27cd22c1.js";import{t as R}from"./toastMixin-b036065d.js";var P={exports:{}};/*!
  * Bootstrap offcanvas.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(s,v){(function(g,a){s.exports=a(ne(),ie(),re(),le(),de(),he(),ce(),_e())})(H,function(g,a,i,d,h,n,f,k){const q="offcanvas",r=".bs.offcanvas",A=".data-api",B=`load${r}${A}`,M="Escape",x="show",y="showing",S="hiding",F="offcanvas-backdrop",T=".offcanvas.show",K=`show${r}`,W=`shown${r}`,Y=`hide${r}`,D=`hidePrevented${r}`,$=`hidden${r}`,j=`resize${r}`,z=`click${r}${A}`,G=`keydown.dismiss${r}`,Q='[data-bs-toggle="offcanvas"]',J={backdrop:!0,keyboard:!0,scroll:!1},U={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class c extends g{constructor(t,o){super(t,o),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return J}static get DefaultType(){return U}static get NAME(){return q}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){if(this._isShown||a.trigger(this._element,K,{relatedTarget:t}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new k().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(y);const I=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(x),this._element.classList.remove(y),a.trigger(this._element,W,{relatedTarget:t})};this._queueCallback(I,this._element,!0)}hide(){if(!this._isShown||a.trigger(this._element,Y).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(S),this._backdrop.hide();const o=()=>{this._element.classList.remove(x,S),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new k().reset(),a.trigger(this._element,$)};this._queueCallback(o,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const t=()=>{if(this._config.backdrop==="static"){a.trigger(this._element,D);return}this.hide()},o=!!this._config.backdrop;return new d({className:F,isVisible:o,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:o?t:null})}_initializeFocusTrap(){return new n({trapElement:this._element})}_addEventListeners(){a.on(this._element,G,t=>{if(t.key===M){if(this._config.keyboard){this.hide();return}a.trigger(this._element,D)}})}static jQueryInterface(t){return this.each(function(){const o=c.getOrCreateInstance(this,t);if(typeof t=="string"){if(o[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);o[t](this)}})}}return a.on(document,z,Q,function(_){const t=i.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&_.preventDefault(),f.isDisabled(this))return;a.one(t,$,()=>{f.isVisible(this)&&this.focus()});const o=i.findOne(T);o&&o!==t&&c.getInstance(o).hide(),c.getOrCreateInstance(t).toggle(this)}),a.on(window,B,()=>{for(const _ of i.find(T))c.getOrCreateInstance(_).show()}),a.on(window,j,()=>{for(const _ of i.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(_).position!=="fixed"&&c.getOrCreateInstance(_).hide()}),h.enableDismissTrigger(c),f.defineJQueryPlugin(c),c})})(P);var ue=P.exports;const fe=ee(ue);const pe={data(){return{childrenRoute:[],navbarOffcanvas:null}},mixins:[R],methods:{logout(){Z().then(()=>{this.$router.push({name:"admin-login"}),this.showToast({title:"已登出",icon:"success"}),document.cookie="bookstoreAPI=; expires=/"}).catch(s=>{console.error(s)})},openCanvas(){this.navbarOffcanvas.show()},hideCanvas(){this.navbarOffcanvas.hide()}},created(){this.childrenRoute=this.$router.options.routes.find(s=>s.path==="/admin").children},mounted(){this.navbarOffcanvas=new fe(this.$refs.offcanvas,{backdrop:"static"})}},b=s=>(te("data-v-4449ca96"),s=s(),se(),s),me={class:"navbar bg-body-tertiary fixed-top d-block d-lg-none"},be={class:"container-fluid"},ve=b(()=>e("a",{class:"navbar-brand fw-bold",href:"#"},"RECA 書店",-1)),ge=b(()=>e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasNavbar","aria-controls":"offcanvasNavbar","aria-label":"Toggle navigation"},[e("span",{class:"navbar-toggler-icon"})],-1)),ke={class:"offcanvas offcanvas-end",tabindex:"-1",id:"offcanvasNavbar","aria-labelledby":"offcanvasNavbarLabel",ref:"offcanvas"},we=b(()=>e("div",{class:"offcanvas-header"},[e("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1)),Ee={class:"offcanvas-body px-0"},Ce={class:"navbar-nav justify-content-end flex-grow-1"},Ne={class:"dashboard position-fixed start-0 top-0 vh-100 d-lg-flex d-none flex-column py-3 pt-4"},Ae=b(()=>e("a",{class:"navbar-brand fs-4 text-white d-flex align-items-center gap-2",href:"#"},[e("span",{class:"fs-4 fw-bold border-secondary border-4 ps-4"},"RECA書店")],-1)),xe=b(()=>e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},[e("span",{class:"navbar-toggler-icon"})],-1)),ye={class:"collapse navbar-collapse d-block flex-column justify-content-between w-100",id:"navbarNav",ref:"navbarCollapse"},Se={class:"navbar-nav flex-column w-100"};function Te(s,v,g,a,i,d){const h=p("RouterLink");return l(),u(w,null,[e("nav",me,[e("div",be,[ve,ge,e("div",ke,[we,e("div",Ee,[e("ul",Ce,[(l(!0),u(w,null,L(i.childrenRoute,n=>(l(),u("li",{class:"nav-item",key:n.name},[m(h,{class:"nav-link rounded-0",to:{name:n.name},onClick:O(d.hideCanvas,["prevent"])},{default:E(()=>[C(N(n.meta.title),1)]),_:2},1032,["to","onClick"])]))),128))])])],512)])]),e("nav",Ne,[Ae,xe,e("div",ye,[e("ul",Se,[(l(!0),u(w,null,L(i.childrenRoute,n=>(l(),u("li",{class:"nav-item",key:n.name},[m(h,{class:"nav-link",to:{name:n.name}},{default:E(()=>[C(N(n.meta.title),1)]),_:2},1032,["to"])]))),128))]),e("a",{class:"nav-link text-start w-100 mt-5",href:"#",onClick:v[0]||(v[0]=O((...n)=>d.logout&&d.logout(...n),["prevent"]))},"登出")],512)])],64)}const De=V(pe,[["render",Te],["__scopeId","data-v-4449ca96"]]);const $e={data(){return{username:"",checkSuccess:!1}},components:{NavbarComponent:De},mixins:[R],methods:{checkLogin(){X().then(s=>{if(!s.data.success){this.$router.push({name:"admin-login"}),this.showToast({title:"登入失敗",icon:"error",position:"top"});return}this.username=sessionStorage.getItem("username"),this.checkSuccess=!0,this.showToast({title:"登入驗證成功",position:"top",icon:"success"})}).catch(s=>{this.$router.push({name:"admin-login"}),console.error(s),this.showToast({title:"登入失敗",icon:"error",position:"top"})})}},created(){this.checkLogin()}},Ie={class:"d-flex bg-light min-height-100 pt-5 pt-lg-0"},Le={class:"view-area ms-auto"},Oe={class:"border-bottom py-3 bg-white"},Ve={class:"container d-flex align-items-center justify-content-between"},Re={class:"d-flex align-items-center"},Pe={class:"container py-4"};function qe(s,v,g,a,i,d){const h=p("NavbarComponent"),n=p("font-awesome-icon"),f=p("RouterLink"),k=p("RouterView");return l(),u("div",Ie,[m(h,{class:"border-end"}),e("div",Le,[e("div",Oe,[e("div",Ve,[e("div",Re,[m(n,{icon:["fas","user"],class:"me-2"}),e("p",null,"Hi, "+N(i.username),1)]),m(f,{to:{name:"index"},target:"_blank"},{default:E(()=>[C("回到前台")]),_:1})])]),e("div",Pe,[i.checkSuccess?(l(),ae(k,{key:0})):oe("",!0)])])])}const je=V($e,[["render",qe],["__scopeId","data-v-278a708e"]]);export{je as default};
