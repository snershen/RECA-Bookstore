import{$ as n}from"./index-f2fabb71.js";import{S as e}from"./sweetalert2.all-b2eb1d9f.js";import{v as h,w as d,x as i,y as c,z as l}from"./apis-ec1d0107.js";function s(t){let r=t.toString();return r=r.replace(/\B(?=(\d{3})+(?!\d))/g,","),r}const p=n("cartStore",{state:()=>({cartList:[],cartLength:0,saveMoney:0,productCount:0,toastContent:{},isLoading:!1}),getters:{getCartSort:t=>{t.sort(r=>a.price-b.price)}},actions:{showToast(t){e.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:2500,timerProgressBar:!0,...t}).fire()},showAlert(t){return e.fire({confirmButtonText:"確定",cancelButtonText:"取消",...t})},getCart(){h().then(t=>{this.cartList=t.data.data,this.cartList.carts.forEach(r=>{r.final_total=s(r.final_total),r.total=s(r.total)}),console.log(this.cartList),this.cartList.final_total=Math.round(this.cartList.final_total),this.cartLength=t.data.data.carts.length,this.saveMoney=Math.round(t.data.data.total-t.data.data.final_total),this.saveMoney=s(this.saveMoney),this.cartList.final_total=s(this.cartList.final_total),this.cartList.total=s(this.cartList.total)})},deleteCart(t){d(t).then(r=>{this.getCart()})},editCart(t,r){this.productCount=t.qty,r?this.productCount++:this.productCount--;const o={data:{product_id:t.id,qty:this.productCount}};i(t.id,o).then(u=>{t.qty=this.productCount,t.qty===0&&this.deleteCart(t.id),this.getCart()})},changeCartNum(t){this.productCount=t.qty;const r={data:{product_id:t.id,qty:this.productCount}};i(t.id,r).then(o=>{t.qty=this.productCount,t.qty===0&&this.deleteCart(t.id),this.getCart()})},deleteAllCart(){this.showAlert({title:"確定要移除購物車所有商品嗎？",showCancelButton:!0,icon:"info"}).then(t=>{t.isConfirmed&&(this.isLoading=!0,c().then(r=>{this.isLoading=!1,console.log(r),this.getCart()}))})},addCart(t){l({data:{product_id:t,qty:1}}).then(o=>{this.showToast({title:"成功加入購物車",icon:"success"}),this.getCart()})}}});export{p as c};
